# --------------------
# File: hawki/core/static_rule_engine/rules/gas_limit_vulnerability.py
# --------------------
"""
obsolute: this rule is redundant with unbounded_loop and gas_griefing rules, and should be removed in favor of those more specific rules.
Gas limit vulnerability: loops over dynamic arrays may exceed block gas limit.
"""

# from . import BaseRule

# class GasLimitVulnerabilityRule(BaseRule):
#     severity = "Low"
#     explanation_template = (
#         "Loops that iterate over dynamic arrays of unbounded length can exceed the block gas limit, "
#         "causing the function to always revert and effectively locking funds."
#     )
#     impact_template = (
#         "An attacker could fill the array to make the function uncallable, leading to denial of service."
#     )
#     fix_template = (
#         "Avoid loops over dynamic arrays, or implement pagination so that only a limited number of items "
#         "are processed per transaction."
#     )

#     def run_check(self, contract_data):
#         findings = []
#         import re
#         for contract in contract_data:
#             source = contract.get("source", "")
#             # Look for loops that use .length
#             loop_pattern = re.compile(r'(for|while)\s*\(.*\.length.*\)')
#             matches = loop_pattern.finditer(source)
#             for match in matches:
#                 line = source[:match.start()].count('\n') + 1
#                 snippet = source[match.start():match.end()]
#                 findings.append(self._create_finding(
#                     title="Unbounded loop may cause gas exhaustion",
#                     file=contract.get("path", ""),
#                     line=line,
#                     vulnerable_snippet=snippet,
#                 ))
#         return findings
# # EOF: hawki/core/static_rule_engine/rules/gas_limit_vulnerability.py