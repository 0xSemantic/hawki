# --------------------
# File: hawki/core/static_rule_engine/rules/gas_limit_vulnerability.py
# --------------------
"""
Gas limit vulnerability: loops over dynamic arrays may exceed block gas limit.
"""

from . import BaseRule

class GasLimitVulnerabilityRule(BaseRule):
    def run_check(self, contract_data):
        findings = []
        for contract in contract_data:
            source = contract.get("source", "")
            # naive: flag loops over arrays without length checks
            if "for" in source and "length" in source:
                findings.append({
                    "rule": "GasLimit",
                    "severity": "LOW",
                    "description": "Loops over dynamic arrays may exceed block gas limit.",
                    "location": contract.get("path"),
                })
        return findings
# EOF: hawki/core/static_rule_engine/rules/gas_limit_vulnerability.py